# Edicus 주문 프로세스 가이드

이 문서는 Edicus SDK를 이용한 인쇄물 편집 및 주문 시스템의 라이프사이클을 설명합니다. 주문 프로세스는 크게 **잠정 주문(Tentative Order)**과 **확정 주문(Definitive Order)**의 두 가지 핵심 단계를 거쳐 완료됩니다.

## 주문 상태 흐름도 (Lifecycle)

전체적인 주문 상태의 변화는 다음과 같습니다.

1.  **Editing (편집 중)**: 초기 상태. 사용자가 디자인을 자유롭게 편집하고 저장할 수 있습니다.
2.  **Tentative Order (잠정 주문)**: 사용자가 편집을 마치고 주문을 요청한 상태. (편집 잠금)
3.  **Definitive Order (확정 주문)**: 결제 완료 등으로 주문이 최종 승인된 상태. (생산 시작)

---

## 1. Tentative Order (잠정 주문)

사용자가 편집기에서 디자인 작업을 마치고 결제를 완료하면 진행하는 단계입니다. 이 단계는 실제 생산에 들어가기 전, 주문 의사를 시스템에 등록하는 과정입니다.

*   **주문 상태값**: `ordering`
*   **주요 특징**:
    *   **편집 잠금 (Lock)**: 사용자가 더 이상 디자인을 수정하거나 저장할 수 없습니다. 데이터 무결성을 위해 편집 권한이 회수됩니다.
    *   **취소 가능 (Cancellable)**: 아직 확정된 주문이 아니므로, 사용자는 주문을 취소하고 다시 '편집 중' 상태로 돌아갈 수 있습니다.
*   **가능한 액션**:
    *   주문 확정 (-> Definitive Order)
    *   주문 취소 (-> Editing 상태로 복귀)

> **API 호출 예시**:
> `POST /api/projects/{project_id}/order/tentative`

---

## 2. Definitive Order (확정 주문)

잠정 주문 상태에서 생산 개시를 하는 단계입니다. 이 단계부터는 시스템이 실제 인쇄를 위한 고해상도 파일 (pdf, jpg/png등)을 생성합니다.

*   **주문 상태값**: `ordered`
*   **주요 특징**:
    *   **취소 불가 (Non-cancellable)**: 이미 생산 프로세스(렌더링 등)가 시작되었으므로 주문을 취소할 수 없습니다.
    *   **생산 파일 생성**: PDF, JPG 등의 고해상도 인쇄용 파일 렌더링(Rendering)이 시작됩니다.
    *   **다운로드 가능**: 렌더링이 완료되면 생산 파일을 다운로드할 수 있습니다.
*   **가능한 액션**:
    *   생산 파일 다운로드
    *   재주문 (Re-order 로직에 따름)

> **API 호출 예시**:
> `POST /api/projects/{project_id}/order/definitive`

---

## 3. 주문 취소 (Cancel Order)

잠정 주문 상태에서 고객이 마음이 바뀌거나 수정을 원할 때 수행하는 프로세스입니다.

*   **전제 조건**: 주문 상태가 반드시 **Tentative (ordering)** 상태여야 합니다. (확정 주문은 취소 불가)
*   **결과**:
    *   주문 상태가 다시 **Editing (editing)**으로 변경됩니다.
    *   사용자는 다시 편집기를 열어 디자인을 수정하고 저장할 수 있게 됩니다.

---

## 요약 테이블

| 단계 | 상태 코드 (Status) | 편집 가능 여부 | 취소 가능 여부 | 설명 |
| :--- | :--- | :---: | :---: | :--- |
| **편집 중** | `editing` | O | - | 디자인 작업 진행 중 |
| **잠정 주문** | `ordering` | X | O | 편집 완료, 결제 완료 상태 |
| **확정 주문** | `ordered` | X | X | 주문 완료, PDF 생성 및 생산 단계 진입 |

